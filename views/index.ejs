<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title><%=title%></title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='index.css'>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Signika:wght@500&display=swap" rel="stylesheet"> 
</head>
<body>
    <!-- Main containerwhich contains everything of the list -->
    <div id="container">
        <!-- Div which contains form and all the todos -->
        <div id="form">
            <!-- Form with input fileds to add more todos. Routes to /add once it is submitted-->
            <form action="/add" method="POST">
                <!-- Main heading -->
                <h1 style="text-align: center;">To-Do List</h1>
                <!-- Div which contains description input field along with the label -->
                <div id="desc">
                    <h5>Description</h5>
                    <input type="text" id="desccss" class="inputcss" name="desc" placeholder="Add an Activity" required style="color: #085078;">
                </div>
                <!-- This div contains type of todo and date -->
                <div id="typeanddate">
                    <!-- Has two parts left and right. Left contains select menu with options  -->
                    <div id="typeanddateleft" class="typeanddateplacement">
                        <h5>Category</h5> 
                        <select name="type" class="inputcss" required>
                            <option value="">Please choose a category</option>
                            <option value="personal">Personal</option>
                            <option value="work">Work</option>
                            <option value="home">Home</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <!-- Right Contains date picker -->
                    <div id="typeanddateright" class="typeanddateplacement">
                        <h5>Pick a Date</h5>
                        <input type="date" class="inputcss" name="when" placeholder="dd/mm/yyyy" required>
                    </div>
                </div>
                <!-- Div for both add and delete button -->
                <div id="buttons">
                    <button type="submit" class="buton">Add Task</button>
                    <input type="button" class="buton" id="delete" value="Delete Task" />
                </div>
                <!-- following is the div where all the todos are placed -->
                <div id="todos">
                    <!-- looping over all the todos present in the list passed through index.js -->
                    <% for(let i of todos){%>
                        <div class="todoscontainer">
                            <div class="todoleft">
                                <div class="todoleftcheckboxarrangement">
                                    <!-- attaching id generated by mongo to all the checkboxes -->
                                    <input type="checkbox" id="<%=i._id%>">
                                </div>
                                <div class="todoleftarrangement">
                                    <div class="tododesc">
                                        <p><%=i.desc%></p>
                                    </div>
                                    <div class="tododate">
                                        <!-- converting date to show just the date and not the time -->
                                        <h5><%=i.date.toDateString()%></h5>
                                    </div>
                                </div>
                            </div>
                            <!-- Right part of todo contains the category of todo -->
                            <div class="todoright">
                                <div class="todotype">
                                    <%=i.category%>
                                </div>
                            </div>
                        </div>
                    <%}%>
                </div>
            </form>
        </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        // To handle the event when button is clicked
        $("#delete").click(function(){
            // checking the number of checked checkboxes
            var len=$( "input:checked" );
            let url='/delete?id=';
            // adding the ids of all the checkboxes in the url with & id=
            for(let i=0;i<len.length;i++)
            {
                if(i==0){
                    url= url + len[i].id;
                }
                else{
                    url= url + '&id=' + len[i].id;
                }
            }
            // redirecting the page to the newly created delete url
            window.location.href=url;
        })
    </script>
</body>
</html>